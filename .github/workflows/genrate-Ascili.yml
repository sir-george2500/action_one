name: Conditional Branch Execution

on:
  push:
    branches:
      - main
      - develop # This workflow runs on main and develop
  pull_request:
    branches:
      - main
      - develop
  workflow_dispatch: # Allows manual triggering

jobs:
  build_and_test:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Dummy Build Step
        run: echo "Building application..."

      - name: Dummy Test Step
        run: echo "Running tests..."

  # This job depends on the build_and_test job
  deploy_or_notify:
    runs-on: ubuntu-latest
    needs: build_and_test

    steps:
      - name: Checkout code (for deployment steps)
        uses: actions/checkout@v4

      - name: Notification or Parting Step (Only on main branch)
        if: github.ref == 'refs/heads/main' # <--- The key expression for conditional execution
        run: |
          echo "This step is executing ONLY because we are on the main branch!"
          echo "Triggering final production sync or sending success notification."
          # Add your main branch specific actions here, e.g.:
          # aws s3 sync ./build s3://my-production-bucket
          # slack-notify "Deployment to production successful!"

      - name: Step for all branches (except main)
        if: github.ref != 'refs/heads/main' # <--- Another conditional example
        run: |
          echo "This step runs on any branch EXCEPT main (e.g., develop, feature branches)."
          echo "Performing staging deployment or feature branch specific actions."